<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" width="1200" height="940" viewBox="0 0 1200 940">
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#555" />
    </marker>
  </defs>
  <!-- Background for dark/light modes -->
  <rect x="0" y="0" width="1200" height="940" fill="#ffffff" />

  <!-- Title -->
  <text x="600" y="40" text-anchor="middle" fill="#0a0a0a" font-family="Segoe UI, Roboto, Arial" font-size="22" font-weight="700">FSFramework – Module Interactions (Detailed)</text>

  <!-- App entry -->
  <rect x="510" y="70" width="180" height="50" rx="8" ry="8" fill="#f9f9f9" stroke="#444" stroke-width="2" />
  <text x="600" y="100" text-anchor="middle" fill="#0a0a0a" font-family="Segoe UI, Roboto, Arial" font-size="16" font-weight="600">FSFramework (App)</text>
  <text x="600" y="120" text-anchor="middle" fill="#303030" font-family="Segoe UI, Roboto, Arial" font-size="14">Primary Game Module</text>

  <!-- FSPlugin (top orchestrator) -->
  <rect x="430" y="140" width="340" height="70" rx="8" ry="8" fill="#f9f9f9" stroke="#444" stroke-width="2" />
  <text x="600" y="175" text-anchor="middle" fill="#0a0a0a" font-family="Segoe UI, Roboto, Arial" font-size="16" font-weight="600">FSPlugin</text>
  <text x="600" y="195" text-anchor="middle" fill="#303030" font-family="Segoe UI, Roboto, Arial" font-size="14">Cross-cutting orchestration</text>

  <!-- Brokers row (GameInstance/World) -->
  <rect x="200" y="240" width="350" height="70" rx="8" ry="8" fill="#f9f9f9" stroke="#444" stroke-width="2" />
  <text x="375" y="275" text-anchor="middle" fill="#0a0a0a" font-family="Segoe UI, Roboto, Arial" font-size="16" font-weight="600">UFSGameInstanceBroker</text>
  <text x="375" y="295" text-anchor="middle" fill="#303030" font-family="Segoe UI, Roboto, Arial" font-size="14">App-wide services/state</text>

  <rect x="650" y="240" width="350" height="70" rx="8" ry="8" fill="#f9f9f9" stroke="#444" stroke-width="2" />
  <text x="825" y="275" text-anchor="middle" fill="#0a0a0a" font-family="Segoe UI, Roboto, Arial" font-size="16" font-weight="600">UFSWorldBroker</text>
  <text x="825" y="295" text-anchor="middle" fill="#303030" font-family="Segoe UI, Roboto, Arial" font-size="14">Per-world coordination</text>

  <!-- Layer boxes (Core / Gameplay / GameFramework / UI) -->
  <rect x="70" y="360" width="240" height="380" rx="8" ry="8" fill="#fef7f0" stroke="#a35d00" stroke-width="2" />
  <text x="190" y="390" text-anchor="middle" fill="#0a0a0a" font-family="Segoe UI, Roboto, Arial" font-size="16" font-weight="600">FSCore</text>
  <text x="190" y="410" text-anchor="middle" fill="#303030" font-family="Segoe UI, Roboto, Arial" font-size="14">Data types, assets, logging</text>
  <text x="190" y="440" text-anchor="middle" fill="#303030" font-family="Segoe UI, Roboto, Arial" font-size="14">FSBrokerDataTypes</text>
  <text x="190" y="462" text-anchor="middle" fill="#303030" font-family="Segoe UI, Roboto, Arial" font-size="14">FSErrorHandler (FS_Log_*)</text>

  <rect x="340" y="360" width="240" height="380" rx="8" ry="8" fill="#f3fff3" stroke="#2b7a0b" stroke-width="2" />
  <text x="460" y="390" text-anchor="middle" fill="#0a0a0a" font-family="Segoe UI, Roboto, Arial" font-size="16" font-weight="600">FSGameplay</text>
  <text x="460" y="410" text-anchor="middle" fill="#303030" font-family="Segoe UI, Roboto, Arial" font-size="14">World systems &amp; actors</text>
  <text x="460" y="440" text-anchor="middle" fill="#303030" font-family="Segoe UI, Roboto, Arial" font-size="14">UFSGameplayBroker (World)</text>
  <text x="460" y="462" text-anchor="middle" fill="#303030" font-family="Segoe UI, Roboto, Arial" font-size="14">UFSEventManager (World)</text>
  <text x="460" y="484" text-anchor="middle" fill="#303030" font-family="Segoe UI, Roboto, Arial" font-size="14">UFSGameDataSubsystem (GI)</text>

  <rect x="610" y="360" width="240" height="380" rx="8" ry="8" fill="#fff6fb" stroke="#9c2f74" stroke-width="2" />
  <text x="730" y="390" text-anchor="middle" fill="#0a0a0a" font-family="Segoe UI, Roboto, Arial" font-size="16" font-weight="600">FSGameFramework</text>
  <text x="730" y="410" text-anchor="middle" fill="#303030" font-family="Segoe UI, Roboto, Arial" font-size="14">Modes, States, Controllers</text>
  <text x="730" y="440" text-anchor="middle" fill="#303030" font-family="Segoe UI, Roboto, Arial" font-size="14">Menu / Lobby / Match</text>
  <text x="730" y="462" text-anchor="middle" fill="#303030" font-family="Segoe UI, Roboto, Arial" font-size="14">Context Brokers</text>

  <rect x="880" y="360" width="240" height="380" rx="8" ry="8" fill="#f5f7ff" stroke="#3344aa" stroke-width="2" />
  <text x="1000" y="390" text-anchor="middle" fill="#0a0a0a" font-family="Segoe UI, Roboto, Arial" font-size="16" font-weight="600">FSUI</text>
  <text x="1000" y="410" text-anchor="middle" fill="#303030" font-family="Segoe UI, Roboto, Arial" font-size="14">HUD, Widgets, Components</text>
  <text x="1000" y="440" text-anchor="middle" fill="#303030" font-family="Segoe UI, Roboto, Arial" font-size="14">UFSUIBrokerBase (World)</text>
  <text x="1000" y="462" text-anchor="middle" fill="#303030" font-family="Segoe UI, Roboto, Arial" font-size="14">Menu / Lobby / Match</text>

  <!-- Arrows from App to FSPlugin -->
  <line x1="600" y1="120" x2="600" y2="140" stroke="#555" stroke-width="2" fill="none" marker-end="url(#arrowhead)" />

  <!-- Arrows from FSPlugin to Brokers -->
  <line x1="550" y1="210" x2="375" y2="240" stroke="#555" stroke-width="2" fill="none" marker-end="url(#arrowhead)" />
  <line x1="650" y1="210" x2="825" y2="240" stroke="#555" stroke-width="2" fill="none" marker-end="url(#arrowhead)" />

  <!-- Arrows from Brokers to Layers -->
  <line x1="375" y1="310" x2="190" y2="360" stroke="#555" stroke-width="2" fill="none" marker-end="url(#arrowhead)" stroke-dasharray="6 6" />
  <line x1="825" y1="310" x2="460" y2="360" stroke="#555" stroke-width="2" fill="none" marker-end="url(#arrowhead)" />
  <line x1="825" y1="310" x2="730" y2="360" stroke="#555" stroke-width="2" fill="none" marker-end="url(#arrowhead)" />
  <line x1="825" y1="310" x2="1000" y2="360" stroke="#555" stroke-width="2" fill="none" marker-end="url(#arrowhead)" />

  <!-- Cross-layer interactions (staggered to avoid overlap) -->
  <!-- Gameplay → Framework -->
  <line x1="310" y1="520" x2="610" y2="520" stroke="#555" stroke-width="2" fill="none" marker-end="url(#arrowhead)" />
  <text x="460" y="510" text-anchor="middle" fill="#303030" font-family="Segoe UI, Roboto, Arial" font-size="14">Gameplay events → Framework</text>

  <!-- Framework → UI -->
  <line x1="730" y1="540" x2="1000" y2="540" stroke="#555" stroke-width="2" fill="none" marker-end="url(#arrowhead)" />
  <text x="865" y="530" text-anchor="middle" fill="#303030" font-family="Segoe UI, Roboto, Arial" font-size="14">State/data → UI brokers</text>

  <!-- UI → Framework (reverse) -->
  <line x1="1000" y1="555" x2="730" y2="555" stroke="#555" stroke-width="2" fill="none" marker-end="url(#arrowhead)" stroke-dasharray="6 6" />
  <text x="865" y="570" text-anchor="middle" fill="#303030" font-family="Segoe UI, Roboto, Arial" font-size="13">UI input/commands</text>

  <!-- Core ↔ All layers (staggered sets) -->
  <!-- Core ↔ Gameplay -->
  <line x1="190" y1="580" x2="460" y2="580" stroke="#555" stroke-width="2" fill="none" marker-end="url(#arrowhead)" />
  <line x1="460" y1="595" x2="190" y2="595" stroke="#555" stroke-width="2" fill="none" marker-end="url(#arrowhead)" stroke-dasharray="6 6" />
  <text x="325" y="575" text-anchor="middle" fill="#303030" font-family="Segoe UI, Roboto, Arial" font-size="13">FSGameplay depends on FSCore</text>
  <!-- Core ↔ Framework -->
  <line x1="190" y1="620" x2="730" y2="620" stroke="#555" stroke-width="2" fill="none" marker-end="url(#arrowhead)" />
  <line x1="730" y1="635" x2="190" y2="635" stroke="#555" stroke-width="2" fill="none" marker-end="url(#arrowhead)" stroke-dasharray="6 6" />
  <text x="460" y="615" text-anchor="middle" fill="#303030" font-family="Segoe UI, Roboto, Arial" font-size="13">FSGameFramework depends on FSCore</text>
  <!-- Core ↔ UI -->
  <line x1="190" y1="660" x2="1000" y2="660" stroke="#555" stroke-width="2" fill="none" marker-end="url(#arrowhead)" />
  <line x1="1000" y1="675" x2="190" y2="675" stroke="#555" stroke-width="2" fill="none" marker-end="url(#arrowhead)" stroke-dasharray="6 6" />
  <text x="595" y="655" text-anchor="middle" fill="#303030" font-family="Segoe UI, Roboto, Arial" font-size="13">FSUI depends on FSCore</text>
  <text x="325" y="565" text-anchor="middle" fill="#303030" font-family="Segoe UI, Roboto, Arial" font-size="14">Types/logging from Core</text>

  <!-- Gameplay ↔ Framework (reverse, separate height) -->
  <line x1="730" y1="600" x2="460" y2="600" stroke="#555" stroke-width="2" fill="none" marker-end="url(#arrowhead)" stroke-dasharray="6 6" />
  <text x="595" y="595" text-anchor="middle" fill="#303030" font-family="Segoe UI, Roboto, Arial" font-size="13">Framework orchestrates Gameplay</text>

  <!-- Gameplay ↔ UI (bi-directional) at distinct height) -->
  <line x1="460" y1="700" x2="1000" y2="700" stroke="#555" stroke-width="2" fill="none" marker-end="url(#arrowhead)" />
  <line x1="1000" y1="715" x2="460" y2="715" stroke="#555" stroke-width="2" fill="none" marker-end="url(#arrowhead)" stroke-dasharray="6 6" />
  <text x="730" y="695" text-anchor="middle" fill="#303030" font-family="Segoe UI, Roboto, Arial" font-size="13">Gameplay data to UI</text>
  <text x="730" y="730" text-anchor="middle" fill="#303030" font-family="Segoe UI, Roboto, Arial" font-size="13">UI actions to Gameplay</text>

  <!-- Legend -->
  <rect x="60" y="840" width="1080" height="80" rx="8" ry="8" fill="#f9fbff" stroke="#2a4b8d" stroke-width="2" />
  <text x="80" y="865" fill="#222" font-family="Segoe UI, Roboto, Arial" font-size="14">Legend:</text>
  <rect x="150" y="850" width="20" height="14" rx="4" ry="4" fill="#fef7f0" stroke="#a35d00" stroke-width="2" />
  <text x="180" y="862" fill="#222" font-family="Segoe UI, Roboto, Arial" font-size="14">FSCore</text>
  <rect x="260" y="850" width="20" height="14" rx="4" ry="4" fill="#f3fff3" stroke="#2b7a0b" stroke-width="2" />
  <text x="290" y="862" fill="#222" font-family="Segoe UI, Roboto, Arial" font-size="14">FSGameplay</text>
  <rect x="400" y="850" width="20" height="14" rx="4" ry="4" fill="#fff6fb" stroke="#9c2f74" stroke-width="2" />
  <text x="430" y="862" fill="#222" font-family="Segoe UI, Roboto, Arial" font-size="14">FSGameFramework</text>
  <rect x="560" y="850" width="20" height="14" rx="4" ry="4" fill="#f5f7ff" stroke="#3344aa" stroke-width="2" />
  <text x="590" y="862" fill="#222" font-family="Segoe UI, Roboto, Arial" font-size="14">FSUI</text>
  <rect x="690" y="850" width="20" height="14" rx="4" ry="4" fill="#f9f9f9" stroke="#444" stroke-width="2" />
  <text x="720" y="862" fill="#222" font-family="Segoe UI, Roboto, Arial" font-size="14">FSPlugin / App</text>
  <line x1="880" y1="858" x2="930" y2="858" stroke="#555" stroke-width="2" fill="none" marker-end="url(#arrowhead)" />
  <text x="940" y="862" fill="#222" font-family="Segoe UI, Roboto, Arial" font-size="14">Primary interactions</text>
  <line x1="880" y1="882" x2="930" y2="882" stroke="#555" stroke-width="2" fill="none" stroke-dasharray="6 6" marker-end="url(#arrowhead)" />
  <text x="940" y="886" fill="#222" font-family="Segoe UI, Roboto, Arial" font-size="14">Support/indirect interactions</text>
</svg>

